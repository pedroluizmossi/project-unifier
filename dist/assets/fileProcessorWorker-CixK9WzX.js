(function(){"use strict";const f={".py":"python",".js":"javascript",".ts":"typescript",".jsx":"jsx",".tsx":"tsx",".html":"html",".css":"css",".scss":"scss",".json":"json",".xml":"xml",".yml":"yaml",".yaml":"yaml",".md":"markdown",".sql":"sql",".sh":"shell",".bat":"batch",".ps1":"powershell",".java":"java",".c":"c",".cpp":"cpp",".h":"c",".hpp":"cpp",".cs":"csharp",".rb":"ruby",".go":"go",".rs":"rust",".php":"php",".vue":"vue",".dockerfile":"dockerfile",".toml":"toml"},i=async l=>{const a=await l.arrayBuffer(),t=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(t)).map(r=>r.toString(16).padStart(2,"0")).join("")},h=async(l,a,t)=>{try{const e=await l.getFile(),r=e.size,o=e.name.toLowerCase();let s="";if(o.startsWith(".")?s=o:o.includes(".")&&(s="."+o.split(".").pop()),t>0&&r>t)return{path:a,size_kb:r/1024,type:"large_file",sha256:await i(e)};try{const n=await e.text();return{path:a,size_kb:r/1024,type:"text_file",content:n,line_count:n.split(`
`).length,language:f[s.toLowerCase()]||""}}catch{return{path:a,size_kb:r/1024,type:"binary_file",sha256:await i(e)}}}catch(e){return console.warn(`Could not process file ${a}:`,e),null}};let c=!1;self.onmessage=async l=>{const{type:a,fileHandles:t,maxSizeBytes:e}=l.data;if(a==="cancel"){c=!1;return}if(a==="process-files"&&t&&e!==void 0){c=!0;const r=t.length,o=[];try{for(let s=0;s<t.length&&c;s++){const{handle:n,path:y}=t[s],p=await h(n,y,e);if(p&&o.push(p),(s+1)%10===0||s===t.length-1){const u={type:"progress",processed:s+1,total:r};self.postMessage(u)}}if(c){const s={type:"complete",filesData:o,processed:r,total:r};self.postMessage(s)}}catch(s){const n={type:"error",error:s instanceof Error?s.message:"Unknown error"};self.postMessage(n)}finally{c=!1}}}})();
